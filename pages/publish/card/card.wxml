<view class="yupao-common-container">
    <view class='common-publish-header' >
        <text class='common-publish-title'>{{ infoId ? "修改" : "发布" }}找活名片</text>
        <view class='common-publish-tipsbox'>
            <view class='common-publish-tips'>请完善以下信息</view>
        </view>
    </view>

    <view class='common-publish-body'>
        <view class='common-publish-content common-shaded-box'>
            <view class='common-publish-item'>
                <view class='common-publish-item-content'>
                    <text class='common-publish-words'>人员构成</text>
                    <picker  bindchange="bindPickerChange" value="{{ ( cardInfo.teamId -1 ) }}" range="{{ cardInfo.team }}">
                        <view  class='common-publish-allwords' >{{ cardInfo.team[( cardInfo.teamId -1 )] }}</view>
                    </picker>
                </view>
            </view>
            <view class='common-publish-item'>
                <view class='common-publish-item-content'>
                    <text class='common-publish-words'>名称</text>
                    <input class='common-publish-input' value='{{ cardInfo.title }}' placeholder='请输入名称' bindinput='userEnterTitle'></input>
                </view>
            </view>
            <view class='common-publish-item'>
                <view class='common-publish-item-content'>
                    <text class='common-publish-words'>所属工种</text>
                    <view class='common-publish-allwords' wx:if="{{ cardInfo.workTypeIds.length  }}" bindtap="userChangeWorktype"><block wx:for="{{ cardInfo.workType }}" wx:key="{{ index }}"><text class='user-items-text' wx:if="{{ item.is_check && (item.has_children == 0) }}">{{ item.name }}</text><block wx:for="{{ item.children }}" wx:key="{{ index }}" wx:if="{{ item.is_check }}"><text class='user-items-text'>{{ item.name }}</text></block></block></view>
                    <input class='common-publish-input' disabled placeholder='请选择所属工种'  wx:else="{{ cardInfo.workTypeIds.length }}" bindtap="userChangeWorktype"></input>
                </view>
            </view>
            <view class='common-publish-item'>
                <view class='common-publish-item-content'>
                    <text class='common-publish-words'>接活省份</text>
                        <view class='common-publish-allwords' wx:if="{{ cardInfo.cityIds.length  }}" bindtap="userChangeProvince"><block wx:for="{{ cardInfo.cities }}" wx:key="{{ index }}" wx:if="{{ item.is_check }}"> <text class='user-items-text'>{{ item.name }}</text></block></view>
                        <input class='common-publish-input' disabled placeholder='请选择接活省份'  wx:else="{{ cardInfo.cityIds.length }}" bindtap="userChangeProvince"></input>
                </view>
            </view>
            <view class='common-publish-item'>
                <view class='common-publish-item-content'>
                    <text class='common-publish-words'>联系人</text>
                    <input class='common-publish-input' value='{{ cardInfo.username }}' placeholder='请输入联系人' bindinput='userEnterUsername'></input>
                </view>
            </view>
            <view class='common-publish-item'>
                <view class='common-publish-item-content'>
                    <text class='common-publish-words'>联系电话</text>
                    <input class='common-publish-input' value='{{ userPhone }}' placeholder='请输入联系电话' bindinput='userEnterNewtel'></input>
                </view>
            </view>
            <view class='common-publish-item' wx:if="{{  (userPhone == '') || ((userPhone != cardInfo.cardTel) && (userPhone != cardInfo.memberTel))  }}">
                <view class='common-publish-item-content common-publish-item-code '>
                    <text class='common-publish-words'>验证码</text>
                    <input class='common-publish-input' type='number' value='' placeholder='请输入验证码' maxlength='4' bindinput='userEditPhoneCode'></input>
                    <text class='publish-getcode-btn' bindtap='userGetCode'>{{ codeTips }}</text>
                </view>
            </view>
            <view class='common-publish-item'>
                <text class='common-publihs-contenttips'>找活详情</text>
                <textarea placeholder='{{ textareaTips }}' wx:if="{{ showTextarea }}" value='{{ cardInfo.content }}' focus='{{ textareaActive }}' bindblur='userEnterContent' bindtap='getTextareaFocus'  maxlength="-1"></textarea>
            </view>
        </view>
        <view class='common-publish-content common-shaded-box publish-uploads-img'>
            <view  bindtap='userDoUploads' bindtap='userDoUploads' >
                <view class='publish-uploads-title'>上传图片<view class='allow-not-uploads'><view class='common-uploads-bgbox'><text class='common-trans {{ showUploads ? "user-uploads-active" : "" }}'></text></view>(可以不上传)</view></view>
                <view class='publish-uploads-tips'><text>可上传做过的工程照片、完工现场照片等</text></view>
            </view>
            <view class='publish-uploads-content  publish-uploads-content-bottom clearfix' wx:if="{{ showUploads }}">
                <view class='publish-uploads-item  {{ item.httpurl ? "publish-uploads-item-actice" : "" }}' wx:for="{{ cardInfo.imgs }}" wx:key="index" wx:for-index="index">
                    <view class='uploads-item-content' bindtap='userUploadCardImg' data-index="{{ index }}"  data-type="1">
                        <image src='{{ item.httpurl }}'></image>
                        <view class='del-upload-item-img' catchtap="delCardImg" data-index="{{ index }}">
                            <image src='http://cdn.yupao.com/miniprogram/images/imgs-del.png'></image>
                        </view>
                    </view>
                </view>
                <view class='publish-uploads-item' wx:if="{{ cardInfo.imgs.length < cardInfo.imgnum  }}" wx:for="{{ (cardInfo.imgnum - cardInfo.imgs.length ) }}" wx:key="index">
                    <view class='uploads-item-content' bindtap='userUploadCardImg' data-type="0" data-index="{{ cardInfo.imgs.length + index }}"></view>
                </view>
            </view>
        </view>
    </view>

    <text class='common-sure-btn' bindtap='userPublishCard'>确认发布</text>

</view>

<view class='publish-choose-wordtype' wx:if="{{ showWorkType }}">
    <view class='publish-choose-contentbox common-shaded-box'>
        <view class='publish-choose-header'>选择工种</view>
        <view class='publish-choose-body'>
            <view class='publish-choose-content-item' wx:for="{{ cardInfo.workType }}" wx:key="{{ index }}" wx:for-index="pindex"  wx:if="{{ item.has_children == '1' }}">
                <view class='publish-choose-content-header'>{{ item.name }}</view>
                <view class='publish-choose-content-list' wx:for="{{ item.children }}"  wx:key="{{ index }}" wx:for-index="cindex"  bindtap='userClickItem' data-type='workType'  data-id="{{ item.id }}" data-check="{{ item.is_check }}" data-index='{{ pindex }}' data-key="{{ cindex }}">
                    <text class='choose-content-lish-left'>{{ item.name }}</text>
                    <text class='choose-content-checkbox {{ item.is_check ? "choose-content-checkbox-active":"" }}'></text>
                </view>
            </view>
        </view>
        <view class='publish-choose-footer flex-row'>
            <view bindtap='userSureWorktype'>确定</view>
        </view>
    </view>
</view>

<view class='publish-choose-wordtype' wx:if="{{ showWorkProvince }}">
    <view class='publish-choose-contentbox common-shaded-box'>
        <view class='publish-choose-header'>接活省份</view>
        <view class='publish-choose-body publish-choose-body-padding'>
                <view class='publish-choose-content-list' wx:for="{{ cardInfo.cities }}"  wx:key="{{ index }}" wx:for-index="index"  bindtap='userClickItem' data-type='province'  data-id="{{ item.id }}" data-check="{{ item.is_check }}" data-index='{{ index }}' data-key="-1" >
                    <text class='choose-content-lish-left'>{{ item.name }}</text>
                    <text class='choose-content-checkbox {{ item.is_check ? "choose-content-checkbox-active":"" }}'></text>
                </view>
        </view>
        <view class='publish-choose-footer flex-row'>
            <view bindtap='userSureWorkProvince'>确定</view>
        </view>
    </view>
</view>
